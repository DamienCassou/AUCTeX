AC_INIT(auc-tex,11.14,auc-tex@sunsite.dk)

AC_SET_MAKE
AC_PROG_INSTALL

dnl
dnl Apparently, if you run a shell window in Emacs, it sets the EMACS
dnl environment variable to 't'.  Lets undo the damage.
dnl
if test "${EMACS}" = "t"; then
   EMACS=""
fi

AC_ARG_WITH(emacs,[  --with-emacs            Use Emacs to build], 
	[ if test "${withval}" = "yes"; then EMACS=emacs; else EMACS="${withval}"; fi ])
AC_ARG_WITH(xemacs,[  --with-xemacs          Use XEmacs to build], 
	[ if test "${withval}" = "yes"; then EMACS=xemacs; else EMACS="${withval}"; fi ])

dnl AC_ARG_WITH(doc-dir,[  --with-doc-dir=DIR        Location to install dvi manual],
dnl  [ previewdocdir="${withval}" ; 
dnl    if test ! -d "`eval echo "$previewdocdir"`"  ; then
dnl       AC_MSG_ERROR([--with-doc-dir="$previewdocdir": Directory does not exist])
dnl    fi
dnl    ])


dnl FIXME we should check that it's the right version
AC_PATH_PROGS_REQUIRED(EMACS, $EMACS emacs xemacs, [(X)Emacs not found!  Aborting!  
You must install Emacs 20 or XEmacs for AUC TeX to work.])

AC_XEMACS_P
packagedir=

if test $EMACS_FLAVOR = "xemacs"  ; then
   AC_PATH_PACKAGEDIR
   lispdir="${packagedir}/lisp/auctex"
   infodir="${packagedir}/info"
else
   AC_PATH_LISPDIR
fi

AC_SUBST(PLAT_LISP)
AC_SUBST(packagedir)
AC_SUBST(icondir)

AC_OUTPUT(Makefile)
cat >&2 <<EOF

Congratulations!  Configuration is complete.

Type "make" at the prompt to build preview.
EOF
