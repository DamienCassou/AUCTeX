-*- Outline -*-

Here's how to install preview.  Unlike most packages, preview consists
of a TeX part and an Emacs part.  This makes configuration a bit
trickier than normal.  Please read through this document fully before
installing anything.

Installing preview should be simple: merely configure, make, and make
install.  

* Prerequisites

** A recent pretest of Emacs 21

You need one of the pretest versions of Emacs 21.  Versions 21.0.105
and higher have been tested to work with EPS images, although lower
versions should work with PNG images.  In general, you want the latest
pretest anyway.

** A working AUC-TeX installation

You need a working AUC-TeX installation.  AUC-TeX can be found at
<http://mirrors.sunsite.dk/auctex/www/auctex/>.  All fairly recent
versions should work.

** A working TeX installation

Preview should work with nearly any TeX installation which contains
dvips, though most testing has taken place using teTeX-based
distributions.

* Configure

The first step is to configure the source code, telling it where
various files will be.  To do so, run

./configure [OPTIONS]

On many machines, you will not need to specify any options, but if
configure cannot determine something on its own, you'll need to help
it out with one of these options

--with-emacs=/path/to/emacs

  If you are using a pretest which isn't in your $PATH, or configure
  is not finding the right emacs binary, you can specify it with this
  option.

--with-auctex=/dir

  If AUC-TeX is installed in a non-standard location (not in
  site-lisp), use this option to specify the location.

--with-texmf=/dir
--with-preview-dir=/dir

  Both of these options can be used to specify the location to install
  the preview TeX files.  They are not necessary for most TeX
  installs, but may be used if you don't like the directory that configure
  is suggesting.

  You can specify a part of the TeX directory hierarchy with
  --with-texmf=/dir, and the TeX files will be installed in
  /dir/tex/latex/preview.  Use this if you'd like things installed
  in a TDS directory hierarchy.

  Or, you can specify the exact directory the preview TeX files will
  be installed with --with-preview-dir=/dir.  In this case, the files
  will be placed in /dir.

--with-lispdir=/dir
  
  This tells where to install Emacs Lisp files.  Normally, this option
  is unnecessary, but may be used if you don't like the directory that
  configure is suggesting.

* Building files

Once configure has been run, simply enter

  make

at the prompt to byte-compile the lisp files, extract the TeX files
and build the documentation DVI file.

* Installing files

  make install

will install the files into the locations chosen earlier.  You may
need special privileges to install, e.g. if you are installing into
system directories.

* Load it by putting (require 'preview) into your .emacs.  

Be sure to have AucTeX up and working.  C-c C-c g <RET> should then
give you a graphics preview, if you have a statement like
\usepackage[graphics,floats,textmath,displaymath,delayed]{preview} in
your document preample.

You almost certainly want to put (setq gs-device "x11alpha") into your
.emacs file.  This will turn on anti-aliasing.

If you are using GS 6.63 or later, you might try

(require 'gs)
(setq gs-device "x11")
(setq gs-options 
      (append 
       '("-dTextAlphaBits=4" "-dGraphicsAlphaBits=2" "-dMaxBitmap=10000000") 
       gs-options))

which may give better output.

For more info, read preview.dvi which gets generated by calling make.

I included a sample file circ.tex which you can use for testing around
a bit, and which serves as sort of a reference for initial bug
reports.

Help out!

